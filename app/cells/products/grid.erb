<style>
	.grid {
		margin: 0px 24px;
	}
	.grid-item img {
		width: 100%;
	}
</style>
<div class="grid" id="macy">
  <% @products.each do |product| %>
    <div class="grid-item">
      <%= link_to product do %>
        <%= image_tag url_for(product.preview) %>
      <% end %>
      <div class="text-center">
        <div class="title"><%= product.title %></div>
        <div class="price">$<%= product.price %></div>
      </div>
    </div>
  <% end %>
</div>

<script>
var macy = Macy({
    container: '#macy',
    trueOrder: false,
    waitForImages: false,
    margin: 20,
    columns: 4,
    breakAt: {
        1200: 3,
        940: 2,
        520: 1,
        400: 1
    }
});

var $grid =  $('.grid').isotope({
    itemSelector: '.grid-item',
    percentPosition: true,
    masonry: {
      // use outer width of grid-sizer for columnWidth
      columnWidth: '.grid-item'
    }
});
</script>